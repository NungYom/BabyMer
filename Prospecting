--= CONFIG =--
local defaultCollectTime = 3
local defaultPanShakeTime = 15
local defaultMoveSpeed = 1
--=============

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hrp = char:WaitForChild("HumanoidRootPart")

local posA, posB, posC
local running = false
local moveSpeed = defaultMoveSpeed

------------------------------------------------------
-- GUI FRAME (‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á20%+‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡∏°‡πà)
------------------------------------------------------

local ScreenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
ScreenGui.Name = "MiningGui"

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 205, 0, 165)
Frame.Position = UDim2.new(1, -260, 0, 125)
Frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Frame.BackgroundTransparency = 0.15
Frame.BorderSizePixel = 0

local UIList = Instance.new("UIListLayout", Frame)
UIList.Padding = UDim.new(0, 3)

------------------------------------------------------
-- BUTTON MAKER
------------------------------------------------------

local function MakeButton(text, color)
    local b = Instance.new("TextButton", Frame)
    b.Size = UDim2.new(1, -6, 0, 21)
    b.BackgroundColor3 = color
    b.TextColor3 = Color3.new(1,1,1)
    b.Font = Enum.Font.GothamBold
    b.TextSize = 11
    b.Text = text
    b.BorderSizePixel = 0
    return b
end

local brown = Color3.fromRGB(180,140,100)
local blue = Color3.fromRGB(90,150,255)
local orange = Color3.fromRGB(255,180,60)

------------------------------------------------------
-- POSITION BUTTONS
------------------------------------------------------

local btnA = MakeButton("‡∏Ç‡∏∏‡∏î‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: - , - , -", brown)
local btnB = MakeButton("‡∏£‡πà‡∏≠‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: - , - , -", blue)
local btnC = MakeButton("‡∏Ç‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: - , - , -", orange)

btnA.MouseButton1Click:Connect(function()
    posA = hrp.Position
    btnA.Text = ("‡∏Ç‡∏∏‡∏î‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: %.1f , %.1f , %.1f"):format(posA.X, posA.Y, posA.Z)
end)

btnB.MouseButton1Click:Connect(function()
    posB = hrp.Position
    btnB.Text = ("‡∏£‡πà‡∏≠‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: %.1f , %.1f , %.1f"):format(posB.X, posB.Y, posB.Z)
end)

btnC.MouseButton1Click:Connect(function()
    posC = hrp.Position
    btnC.Text = ("‡∏Ç‡∏≤‡∏¢‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: %.1f , %.1f , %.1f"):format(posC.X, posC.Y, posC.Z)
end)

------------------------------------------------------
-- ‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏∏‡∏î (1‚Äì8)
------------------------------------------------------

local collectTime = defaultCollectTime
local CollectButton = MakeButton("‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏∏‡∏î: "..collectTime.." ‡∏ß‡∏¥", brown)

CollectButton.MouseButton1Click:Connect(function()
    collectTime = collectTime + 1
    if collectTime > 8 then collectTime = 1 end
    CollectButton.Text = "‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏∏‡∏î: "..collectTime.." ‡∏ß‡∏¥"
end)

------------------------------------------------------
-- ‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡πà‡∏≠‡∏ô (3‚Äì25)
------------------------------------------------------

local panTime = defaultPanShakeTime
local PanButton = MakeButton("‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡πà‡∏≠‡∏ô: "..panTime.." ‡∏ß‡∏¥", blue)

PanButton.MouseButton1Click:Connect(function()
    panTime = panTime + 1
    if panTime > 25 then panTime = 3 end
    PanButton.Text = "‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡πà‡∏≠‡∏ô: "..panTime.." ‡∏ß‡∏¥"
end)

------------------------------------------------------
-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà (1‚Äì4)
------------------------------------------------------

local MoveButton = MakeButton("‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà: "..moveSpeed, Color3.fromRGB(140,200,255))

MoveButton.MouseButton1Click:Connect(function()
    moveSpeed = moveSpeed + 1
    if moveSpeed > 4 then moveSpeed = 1 end
    MoveButton.Text = "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà: "..moveSpeed
end)

------------------------------------------------------
-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
------------------------------------------------------

local startBtn = MakeButton("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô", Color3.fromRGB(100,200,100))


------------------------------------------------------
-- Tween / Lerp ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏à‡∏∏‡∏î (‡πÉ‡∏ä‡πâ speed)
------------------------------------------------------

local function tpTo(pos)
    local step = 0.07 * (1 / moveSpeed)
    for i = 0, 1, step do
        hrp.CFrame = hrp.CFrame:Lerp(CFrame.new(pos), i)
        task.wait()
    end
    hrp.CFrame = CFrame.new(pos)
end


------------------------------------------------------
-- üî• ‡∏•‡∏π‡∏õ‡∏ó‡∏µ‡πà 1 : Tween ‡πÑ‡∏õ A ‚Üí B ‚Üí C ‚Üí Loop
------------------------------------------------------

local function movementLoop()
    task.spawn(function()
        while running do
            
            -- ‡πÑ‡∏õ A
            tpTo(posA)
            task.wait(collectTime)

            -- ‡πÑ‡∏õ B
            tpTo(posB)
            task.wait(panTime)

            -- ‡πÑ‡∏õ C
            tpTo(posC)
            task.wait(1)

        end
    end)
end


------------------------------------------------------
-- üî• ‡∏•‡∏π‡∏õ‡∏ó‡∏µ‡πà 2 : ‡∏£‡∏±‡∏ô Collect / Pan / Shake / SellAll ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤
------------------------------------------------------

local function actionLoop()
    task.spawn(function()
        while running do
            -- Collect
            char.DragonflamePan.Scripts.Collect:InvokeServer(1)

            -- Pan & Shake
            char.DragonflamePan.Scripts.Pan:InvokeServer()
            char.DragonflamePan.Scripts.Shake:FireServer()

            -- SellAll
            game.ReplicatedStorage.Remotes.Shop.SellAll:InvokeServer()

            task.wait(0.1)
        end
    end)
end


------------------------------------------------------
-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏° / ‡∏´‡∏¢‡∏∏‡∏î‡∏•‡∏π‡∏õ
------------------------------------------------------

startBtn.MouseButton1Click:Connect(function()
    if not running then
        
        if not posA or not posB or not posC then
            startBtn.Text = "‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏Ñ‡πâ‡∏≤‡∏ö"
            task.wait(2)
            startBtn.Text = "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"
            return
        end

        running = true
        startBtn.Text = "‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å‡∏Ñ‡∏±‡∏ö‡πÄ‡∏ö‡∏ö‡∏µ‡πã"

        movementLoop()
        actionLoop()

    else
        running = false
        startBtn.Text = "‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô"
    end
end)
